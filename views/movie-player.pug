extends layout

block content
  div(class="relative overflow-hidden")
    //- Background image
    div(class="absolute inset-0 z-0")
      img(src=anime.poster alt=`Background for ${anime.title}` class="w-full h-full object-cover blur-lg scale-110" onerror="this.style.display='none'")
      div(class="absolute inset-0 bg-gray-900/80")

    //- Content
    div(class="container mx-auto px-4 py-8 md:py-16 relative z-10")
      div(class="grid grid-cols-1 lg:grid-cols-4 gap-8")
        div(class="lg:col-span-3")
          div(class="aspect-video bg-black rounded-2xl overflow-hidden shadow-2xl mb-6")
            iframe(class="w-full h-full" src=`${stream}` frameborder="0" allow="autoplay; fullscreen" allowfullscreen)

          div(class="text-white")
            h1(class="text-3xl md:text-4xl font-bold mb-3")= anime.title
            if anime.genres && anime.genres.length > 0
              div(class="flex flex-wrap gap-2 mb-4")
                each genre in anime.genres
                  a(href=`/genres/${genre.slug}` class="px-3 py-1 bg-white/10 text-white text-sm rounded-full hover:bg-white/20 transition-colors")= genre.name

        div(class="lg:col-span-1")
          div(class="bg-white/10 backdrop-blur-md rounded-2xl p-6 space-y-4")
            h3(class="font-bold text-white text-xl mb-2") Movie Details
            div(class="space-y-3 text-sm")
              div
                span(class="font-medium text-gray-300") Title:
                span(class="text-gray-400 ml-2")= anime.title
              if anime.status
                div
                  span(class="font-medium text-gray-300") Status:
                  span(class="text-gray-400 ml-2")= anime.status
              if anime.release_date
                div
                  span(class="font-medium text-gray-300") Release:
                  span(class="text-gray-400 ml-2")= anime.release_date
              if anime.rating
                div
                  span(class="font-medium text-gray-300") Rating:
                  span(class="text-gray-400 ml-2")= anime.rating

            div(class="pt-4 border-t border-white/10")
              h3(class="font-bold text-white mb-3") Share
              div(class="flex space-x-3")
                button(onclick=`shareToFacebook('${anime.title}')` class="flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm hover:bg-blue-700 transition-colors") Facebook
                button(onclick=`shareToTwitter('${anime.title}')` class="flex-1 bg-sky-500 text-white py-2 px-3 rounded-lg text-sm hover:bg-sky-600 transition-colors") Twitter
                button(onclick="copyToClipboard()" class="flex-1 bg-gray-600 text-white py-2 px-3 rounded-lg text-sm hover:bg-gray-700 transition-colors") Copy

block scripts
  script.
    function shareToFacebook(title) {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(`Nonton ${title} di ANIMAQU`);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank', 'width=600,height=400');
    }

    function shareToTwitter(title) {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(`Nonton ${title} di ANIMAQU`);
      window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank', 'width=600,height=400');
    }

    function copyToClipboard() {
      navigator.clipboard.writeText(window.location.href).then(() => {
        alert('Link berhasil disalin!');
      }).catch(() => {
        const textArea = document.createElement('textarea');
        textArea.value = window.location.href;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        alert('Link berhasil disalin!');
      });
    }